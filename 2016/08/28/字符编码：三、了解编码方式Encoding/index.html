<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="windy"><title>字符编码：三、了解编码方式Encoding | windy</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">字符编码：三、了解编码方式Encoding</h1><a id="logo" href="/.">windy</a><p class="description">love at first sight</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">字符编码：三、了解编码方式Encoding</h1><div class="post-meta">Aug 28, 2016<span> | </span><span class="category"><a href="/categories/Java基础/">Java基础</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/08/28/字符编码：三、了解编码方式Encoding/" href="/2016/08/28/字符编码：三、了解编码方式Encoding/#comments" class="ds-thread-count"></a><div class="post-content"><ul>
<li><a href="#1">一.编码背景</a> <ul>
<li><a href="#1.1">1.1 为什么需要编码</a> </li>
<li><a href="#1.2">1.2 如何翻译</a> </li>
</ul>
</li>
<li><a href="#2">二.在Java中需要编码的场景</a> </li>
<li><a href="#3">三.在Java中的编解码</a>  <ul>
<li><a href="#3.1">3.1 编码</a>  </li>
<li><a href="#3.2">3.2 Unicode和char</a>  </li>
<li><a href="#3.3">3.3 按照ISO-8859-1编码</a>  </li>
<li><a href="#3.4">3.4 按照UTF-8编码</a>  </li>
<li><a href="#3.5">3.5 按照UTF-16编码</a>  </li>
<li><a href="#3.6">3.6 按照GBK编码</a>  </li>
<li><a href="#3.7">3.7 按照GB2312编码</a>  </li>
</ul>
</li>
<li><a href="#4">四.几种编码方式的对比</a> </li>
</ul>
<p></p><h2 id="1">一、编码背景</h2><p></p>
<p></p><h4 id="1.1">1.1 为什么需要编码</h4><br>为什么要编码？我们能不能不编码？<p></p>
<p>由于人类的语言有太多，因而表示这些语言的符号太多，无法用计算机中<strong>一个基本的存储单元—— byte</strong>来表示，因而必须要经过拆分或一些翻译工作，才能让计算机能理解。我们可以把计算机能够理解的语言假定为英语，其它语言要能够在计算机中使用必须经过一次翻译，把它翻译成英语。这个翻译的过程就是编码。</p>
<p>总的来说，编码的原因可以总结为：  </p>
<ul>
<li>计算机中存储信息的最小单元是一个字节即 <strong>8 个 bit</strong>，所以能表示的字符范围是 0~255 个</li>
<li>人类要表示的符号太多，无法用<strong>一个字节</strong>来完全表示</li>
<li>要解决这个矛盾必须需要一个新的数据结构 char，<strong>从 char 到 byte 必须编码</strong></li>
</ul>
<p></p><h4 id="1.2">1.2 如何“翻译”</h4><br>明白了各种语言需要交流，经过翻译是必要的，那又如何来翻译呢？计算中提拱了多种翻译方式，常见的有<strong>ASCII、ISO-8859-1、GB2312、GBK、UTF-8、UTF-16</strong>等。它们都可以被看作为字典，它们规定了转化的规则，按照这个规则就可以让计算机正确的表示我们的字符。目前的编码格式很多，例如 GB2312、GBK、UTF-8、UTF-16 这几种格式都可以表示一个汉字，那我们到底选择哪种编码格式来存储汉字呢？这就要考虑到其它因素了，是存储空间重要还是编码的效率重要。<p></p>
<p><strong>ASCII 码</strong><br>:  学过计算机的人都知道 ASCII 码，总共有<code>128</code>个，用一个字节的低 7 位表示，0~31 是控制字符如换行回车删除等；32~126 是打印字符，可以通过键盘输入并且能够显示出来。</p>
<p><strong>ISO-8859-1</strong><br>:  128 个字符显然是不够用的，于是 ISO 组织在 ASCII 码基础上又制定了一些列标准用来扩展 ASCII 编码，它们是 ISO-8859-1~ISO-8859-15，其中 ISO-8859-1 涵盖了大多数西欧语言字符，所有应用的最广泛。ISO-8859-1 仍然是单字节编码，它总共能表示 <code>256</code> 个字符。</p>
<p><strong>GB2312</strong><br>:  它的全称是《信息交换用汉字编码字符集 基本集》，它是双字节编码，总的编码范围是 A1-F7，其中从 A1-A9 是符号区，总共包含 682 个符号，从 B0-F7 是汉字区，包含 6763 个汉字。</p>
<p><strong>GBK</strong><br>:  全称叫《汉字内码扩展规范》，是国家技术监督局为 windows95 所制定的新的汉字内码规范，它的出现是为了扩展 GB2312，加入更多的汉字，它的编码范围是 8140~FEFE（去掉 XX7F）总共有 23940 个码位，它能表示 21003 个汉字，它的编码是和 GB2312 兼容的，也就是说用 GB2312 编码的汉字可以用 GBK 来解码，并且不会有乱码。</p>
<p><strong>GB18030</strong><br>:  全称是《信息交换用汉字编码字符集》，是我国的强制标准，它可能是单字节、双字节或者四字节编码，它的编码与 GB2312 编码兼容，这个虽然是国家标准，但是实际应用系统中使用的并不广泛。</p>
<p><strong>UTF-16</strong><br>:  说到 UTF 必须要提到 Unicode（Universal Code 统一码），ISO 试图想创建一个全新的超语言字典，世界上所有的语言都可以通过这本字典来相互翻译。可想而知这个字典是多么的复杂，关于 Unicode 的详细规范可以参考相应文档。Unicode 是 Java 和 XML 的基础，下面详细介绍 Unicode 在计算机中的存储形式。<br>UTF-16 具体定义了 Unicode 字符在计算机中存取方法。<strong>UTF-16 用两个字节来表示 Unicode 转化格式</strong>，这个是定长的表示方法，不论什么字符都可以用两个字节表示，两个字节是 16 个 bit，所以叫 UTF-16。UTF-16 表示字符非常方便，每两个字节表示一个字符，这个在字符串操作时就大大简化了操作，这也是 <strong>Java 以 UTF-16 作为内存的字符存储格式</strong>的一个很重要的原因。 </p>
<p><strong>UTF-8</strong><br>: UTF-16 统一采用两个字节表示一个字符，虽然在表示上非常简单方便，但是也有其缺点，有很大一部分字符用一个字节就可以表示的现在要两个字节表示，存储空间放大了一倍，在现在的网络带宽还非常有限的今天，这样会<strong>增大网络传输的流量</strong>，而且也没必要。而 UTF-8 采用了一种<strong>变长技术</strong>，每个编码区域有不同的字码长度。不同类型的字符可以是由<strong>1~6</strong>个字节组成。</p>
<blockquote>
<p>接下来，非常重要，就是日常我们常用的UTF8编码的一个规则：</p>
<ol>
<li>如果一个字节，最高位（第 8 位）为 0，表示这是一个 ASCII 字符（00 7F）。可见，所有 ASCII 编码已经是 UTF-8 了。</li>
<li>如果一个字节，以 11 开头，连续的 1 的个数暗示这个字符的字节数，例如：110xxxxx 代表它是双字节 UTF-8 字符的首字节。</li>
<li>如果一个字节，以 10 开始，表示它不是首字节，需要向前查找才能得到当前字符的首字节</li>
</ol>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">例如：<span class="string">"钧"</span>字</div><div class="line">unicode：\u94a7  </div><div class="line">二进制为：<span class="number">10010100</span> <span class="number">10100111</span>  </div><div class="line">根据UTF8规则</div><div class="line"><span class="number">1.</span> 最后第一个字节开头为<span class="number">10</span>，补上最后的<span class="number">6</span>位<span class="number">100111</span>，变成<span class="number">10100111</span></div><div class="line"><span class="number">2.</span> 倒数第二个字节开头为<span class="number">10</span>，补上次<span class="number">6</span>位<span class="number">010010</span>，变成<span class="number">10010010</span></div><div class="line"><span class="number">3.</span> 补充完整首字节，<span class="number">1110</span>代表<span class="number">3</span>字节，补上<span class="number">1001</span>，首字节为<span class="number">11101001</span></div><div class="line"><span class="number">4.</span> 最后UTF编码<span class="string">"钧"</span>字：<span class="number">11101001</span> <span class="number">10010010</span> <span class="number">10100111</span></div></pre></td></tr></table></figure>
<p></p><h2 id="2">二、在Java中需要编码的场景</h2><br>涉及编码的地方一般都在从字符到字节或者从字节到字符的转换上，而需要这种转换的场景主要是IO。<p></p>
<p>在IO操作中存在的编码： </p>
<ul>
<li>磁盘IO</li>
<li>网络IO</li>
</ul>
<p>在内存操作中存在的编码：</p>
<ul>
<li>在内存中从字符到字节的数据类型转换</li>
</ul>
<hr>
<p>现在我们总结一下计算机系统通用的字符编码工作方式：</p>
<p>在计算机内存中，统一使用Unicode编码，<strong>当需要保存到硬盘或者需要传输的时候</strong>，就转换为UTF-8编码或者其他编码方式。</p>
<p>用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件：</p>
<p><center><br><img src="http://i.imgur.com/wfzrHKB.png" alt=""><br></center><br>浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器：</p>
<p><center><br><img src="http://i.imgur.com/RZYJNZN.png" alt=""><br></center><br>所以你看到很多网页的源码上会有类似<code>&lt;meta charset=&quot;UTF-8&quot; /&gt;</code>的信息，表示该网页正是用的UTF-8编码。</p>
<p></p><h2 id="3">三、在Java中的编解码</h2><p></p>
<p></p><h4 id="3.1">3.1 编码</h4><br>接下来将用实际例子介绍在Java中如何实现编码和解码，下面以“I am 君山”这个字符串为例介绍 Java 中如何把它以 ISO-8859-1、GB2312、GBK、UTF-16、UTF-8 编码格式进行编码的。<br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public static void encode() &#123;</div><div class="line">    String <span class="built_in">name</span> = <span class="string">"I am 君山"</span>;</div><div class="line">    System.out.println(<span class="string">"name       :"</span> + <span class="built_in">name</span>);</div><div class="line">    System.out.println(<span class="string">"char[]     :"</span>+toHexBits(<span class="built_in">name</span>.toCharArray()));</div><div class="line">    System.out.println(<span class="string">"Unicode    :"</span>+strConvertUnicode(<span class="built_in">name</span>));</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="comment">//null表示采用IDE默认的编码</span></div><div class="line">        toHexBits(<span class="built_in">name</span>, null);</div><div class="line">        toHexBits(<span class="built_in">name</span>, <span class="string">"ISO-8859-1"</span>);</div><div class="line">        toHexBits(<span class="built_in">name</span>, <span class="string">"UTF-8"</span>);</div><div class="line">        toHexBits(<span class="built_in">name</span>, <span class="string">"UTF-16"</span>);</div><div class="line">        toHexBits(<span class="built_in">name</span>, <span class="string">"GBK"</span>);</div><div class="line">        toHexBits(<span class="built_in">name</span>, <span class="string">"GB2312"</span>);</div><div class="line">    &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p>
<p>输出如下：</p>
<pre class="selfblock">
name       :I am 君山
char[]     :49 20 61 6d 20 541b 5c71 
Unicode    :\u0049\u0020\u0061\u006d\u0020\u541b\u5c71
null       :49 20 61 6d 20 e5 90 9b e5 b1 b1 
ISO-8859-1 :49 20 61 6d 20 3f 3f 
UTF-8      :49 20 61 6d 20 e5 90 9b e5 b1 b1 
UTF-16     :fe ff 00 49 00 20 00 61 00 6d 00 20 54 1b 5c 71 
GBK        :49 20 61 6d 20 be fd c9 bd 
GB2312     :49 20 61 6d 20 be fd c9 bd
</pre>

<p>简单分析下：</p>
<ul>
<li>因为Java的字符串是Unicode编码的，所以由字符串得到的char数组分别与unicode的代码点的值是同等的</li>
<li>null表示采用IDE默认的编码，这里我使用的是UTF8，至于编码的规则可以参考UTF8的编码规则</li>
<li>7个char字符经过ISO-8859-1编码变成7个byte数组，ISO-8859-1是单字节编码，中文“君山”被转化成值是 3f 的 byte。3f 也就是“？”字符，所以经常会出现中文变成“？”很可能就是错误的使用了 ISO-8859-1 这个编码导致的</li>
<li>UTF-16中告诉我们这是以Little-Endian存储的UTF-16（UTF-16LE）的文件的开头，后面就是对应的两字节的unicode代码点，这也是UTF-16以两字节作为编码效率高的原因，但不适合网络传输</li>
<li>至于GBK是兼容GB2312，反之则不兼容，而且他们都有自己的码表</li>
</ul>
<p></p><h4 id="3.2">3.2 Unicode和char</h4><br>Java的字符类型char采用的是UTF16编码方式对Unicode编码表进行表示，所以上述两者转换后字节数组一样。<p></p>
<p></p><h4 id="3.3">3.3 按照ISO-8859-1编码</h4><br>字符串“I am 君山”用 ISO-8859-1 编码，下面是编码结果：  <p></p>
<p><img src="http://i.imgur.com/Bc7YUKG.jpg" alt="">  </p>
<p>从上图看出 7 个 char 字符经过 ISO-8859-1 编码转变成 7 个 byte 数组，ISO-8859-1 是<strong>单字节编码</strong>，中文“君山”被转化成值是 <strong>3f 的 byte</strong>。3f 也就是“？”字符，所以经常会出现中文变成“？”很可能就是错误的使用了 ISO-8859-1 这个编码导致的。中文字符经过 ISO-8859-1 编码会丢失信息，通常我们称之为“黑洞”，它会把不认识的字符吸收掉。由于现在大部分基础的 Java 框架或系统默认的字符集编码都是 ISO-8859-1，所以很容易出现乱码问题，后面将会分析不同的乱码形式是怎么出现的。</p>
<p></p><h4 id="3.4">3.4 按照UTF-8编码</h4><br>字符串“I am 君山”用 UTF-8 编码，下面是编码结果：  <p></p>
<p><img src="http://i.imgur.com/SD3bBwA.jpg" alt="">  </p>
<p>UTF-16 虽然编码效率很高，但是对单字节范围内字符也放大了一倍，这无形也浪费了存储空间，另外 UTF-16 采用顺序编码，不能对单个字符的编码值进行校验，如果中间的一个字符码值损坏，后面的所有码值都将受影响。而 UTF-8 这些问题都不存在，UTF-8 对单字节范围内字符仍然用一个字节表示，对汉字采用三个字节表示。<br>UTF-8 编码与 GBK 和 GB2312 不同，<strong>不用查码表</strong>，所以在编码效率上 UTF-8 的效率会更好，所以在<strong>存储中文字符时 UTF-8 编码比较理想</strong>。</p>
<p></p><h4 id="3.5">3.5 按照UTF-16编码</h4><br>字符串“I am 君山”用 UTF-16 编码，下面是编码结果：  <p></p>
<p><img src="http://i.imgur.com/SUmHb2Y.jpg" alt="">  </p>
<p>用 UTF-16 编码将 char 数组放大了一倍，单字节范围内的字符，在高位补 0 变成两个字节，中文字符也变成两个字节。从 UTF-16 编码规则来看，仅仅将字符的高位和地位进行拆分变成两个字节。特点是<strong>编码效率非常高</strong>，<strong>规则很简单</strong>，由于不同处理器对 2 字节处理方式不同，Big-endian（高位字节在前，低位字节在后）或 Little-endian（低位字节在前，高位字节在后）编码，所以在对一串字符串进行编码是需要指明到底是 Big-endian 还是 Little-endian，所以前面有两个字节用来保存 BYTE_ORDER_MARK 值，UTF-16 是用定长 16 位（2 字节）来表示的 UCS-2 或 Unicode 转换格式，通过代理对来访问 BMP 之外的字符编码。</p>
<p></p><h4 id="3.6">3.6 按照GBK编码</h4><br>字符串“I am 君山”用 GBK 编码，下面是编码结果：  <p></p>
<p><img src="http://i.imgur.com/apUAkbV.jpg" alt="">  </p>
<p>你可能已经发现上图与 GB2312 编码的结果是一样的，没错 GBK 与 GB2312 编码结果是一样的，由此可以得出 GBK 编码是兼容 GB2312 编码的，它们的编码算法也是一样的。不同的是它们的码表长度不一样，GBK 包含的汉字字符更多。所以只要是经过 GB2312 编码的汉字都可以用 GBK 进行解码，反过来则不然。</p>
<p></p><h4 id="3.7">3.7 按照GB2312编码</h4><br>字符串“I am 君山”用 GB2312 编码，下面是编码结果：  <p></p>
<p><img src="http://i.imgur.com/rdOEMtt.jpg" alt="">  </p>
<p>GB2312 对应的 Charset 是 <code>sun.nio.cs.ext.EUC_CN</code> 而对应的 <code>CharsetDecoder</code> 编码类是 <code>sun.nio.cs.ext.DoubleByte</code>，GB2312 字符集有一个 char 到 byte 的码表，不同的字符编码就是查这个码表找到与每个字符的对应的字节，然后拼装成 byte 数组。查表的规则如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c2b[c2bIndex[<span class="keyword">char</span> &gt;&gt; <span class="number">8</span>] + (<span class="keyword">char</span> &amp; <span class="number">0xff</span>)]</div></pre></td></tr></table></figure></p>
<p>如果查到的码位值大于 oxff 则是双字节，否则是单字节。双字节高 8 位作为第一个字节，低 8 位作为第二个字节，如下代码所示：<br><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (bb &gt; <span class="number">0xff</span>) &#123;    <span class="comment">// DoubleByte </span></div><div class="line">           <span class="keyword">if</span> (dl - dp &lt; <span class="number">2</span>) </div><div class="line">               <span class="keyword">return</span> CoderResult.OVERFLOW; </div><div class="line">           da[dp++] = (<span class="keyword">byte</span>) (bb &gt;&gt; <span class="number">8</span>); </div><div class="line">           da[dp++] = (<span class="keyword">byte</span>) bb; </div><div class="line">&#125; <span class="keyword">else</span> &#123;                      <span class="comment">// SingleByte </span></div><div class="line">           <span class="keyword">if</span> (dl - dp &lt; <span class="number">1</span>) </div><div class="line">               <span class="keyword">return</span> CoderResult.OVERFLOW; </div><div class="line">           da[dp++] = (<span class="keyword">byte</span>) bb; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>从上图可以看出前 5 个字符经过编码后仍然是 5 个字节，而汉字被编码成双字节，GB2312 只支持 6763 个汉字，所以并不是所有汉字都能够用 GB2312 编码。</p>
<p></p><h2 id="4">四、几种编码方式的比较</h2><p></p>
<blockquote>
<p>对中文字符后面四种编码格式都能处理，GB2312 与 GBK 编码规则类似，但是 GBK 范围更大，它能处理所有汉字字符，所以 GB2312 与 GBK 比较应该选择 GBK。  </p>
<p><strong>UTF-16 与 UTF-8 都是处理 Unicode 编码</strong>，它们的编码规则不太相同，相对来说 <strong>UTF-16 编码效率最高</strong>，<strong>字符到字节相互转换更简单</strong>，进行字符串操作也更好。它适合在本地磁盘和内存之间使用，可以进行字符和字节之间快速切换，如 Java 的内存编码就是采用 UTF-16 编码。但是它不适合在网络之间传输，因为网络传输容易<strong>损坏字节流</strong>，一旦字节流损坏将很难恢复，相比较而言 UTF-8 更适合<strong>网络传输</strong>，对 ASCII 字符采用单字节存储，另外单个字符损坏也不会影响后面其它字符，在<strong>编码效率上介于 GBK 和 UTF-16</strong> 之间，所以 UTF-8 在编码效率上和编码安全性上做了平衡，是理想的中文编码方式。</p>
</blockquote>
<p></p><h2 id="5">五、资料参考</h2><p></p>
<ul>
<li>书籍：许令波–深入分析JavaWeb技术内幕  </li>
<li>文章: <a href="https://www.ibm.com/developerworks/cn/java/j-lo-chinesecoding/" target="_blank" rel="external">深入分析Java中的中文编码问题</a></li>
<li>资源：<a href="http://www.unicode.org/charts" target="_blank" rel="external">Unicode官网代码表</a>  </li>
</ul>
<p>测试代码：</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 将字符转换成字节.</div><div class="line"> * @author zhangjunyong</div><div class="line"> * @version 1.0</div><div class="line"> * @date 2016年08月20日</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> class EncodingBytes &#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</div><div class="line">        EncodingBytes.encode();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> encode() &#123;</div><div class="line">        <span class="keyword">String</span> name = <span class="string">"I am 君山"</span>;</div><div class="line">        System.out.<span class="built_in">println</span>(<span class="string">"name       :"</span> + name);</div><div class="line">        System.out.<span class="built_in">println</span>(<span class="string">"char[]     :"</span>+toHexBits(name.toCharArray()));</div><div class="line">        System.out.<span class="built_in">println</span>(<span class="string">"Unicode    :"</span>+strConvertUnicode(name));</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//采用IDE默认的编码</span></div><div class="line">            toHexBits(name, <span class="keyword">null</span>);</div><div class="line">            toHexBits(name, <span class="string">"ISO-8859-1"</span>);</div><div class="line">            toHexBits(name, <span class="string">"UTF-8"</span>);</div><div class="line">            toHexBits(name, <span class="string">"UTF-16"</span>);</div><div class="line">            toHexBits(name, <span class="string">"GBK"</span>);</div><div class="line">            toHexBits(name, <span class="string">"GB2312"</span>);</div><div class="line">        &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 将字符串转成unicode</div><div class="line">     * @param str 待转字符串</div><div class="line">     * @return unicode字符串</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> strConvertUnicode(<span class="keyword">String</span> <span class="built_in">str</span>) &#123;</div><div class="line">        <span class="built_in">str</span> = (<span class="built_in">str</span> == <span class="keyword">null</span> ? <span class="string">""</span> : <span class="built_in">str</span>);</div><div class="line">        <span class="keyword">String</span> tmp;</div><div class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="number">1000</span>);</div><div class="line">        <span class="built_in">char</span> c;</div><div class="line">        <span class="built_in">int</span> i, j;</div><div class="line">        sb.setLength(<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">str</span>.length(); i++) &#123;</div><div class="line">            c = <span class="built_in">str</span>.charAt(i);</div><div class="line">            sb.<span class="built_in">append</span>(<span class="string">"\\u"</span>);</div><div class="line">            j = (c &gt;&gt;&gt; <span class="number">8</span>); <span class="comment">//取出高8位</span></div><div class="line">            tmp = Integer.toHexString(j);</div><div class="line">            <span class="keyword">if</span> (tmp.length() == <span class="number">1</span>)</div><div class="line">                sb.<span class="built_in">append</span>(<span class="string">"0"</span>);</div><div class="line">            sb.<span class="built_in">append</span>(tmp);</div><div class="line">            j = (c &amp; <span class="number">0xFF</span>); <span class="comment">//取出低8位</span></div><div class="line">            tmp = Integer.toHexString(j);</div><div class="line">            <span class="keyword">if</span> (tmp.length() == <span class="number">1</span>)</div><div class="line">                sb.<span class="built_in">append</span>(<span class="string">"0"</span>);</div><div class="line">            sb.<span class="built_in">append</span>(tmp);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> <span class="keyword">String</span>(sb));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 字符数组转换为16进制.</div><div class="line">     * @date 2016/8/21 18:55</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> toHexBits(<span class="built_in">char</span>[] chars) &#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">char</span> c : chars) &#123;</div><div class="line">            sb.<span class="built_in">append</span>(Integer.toHexString(<span class="number">0xffff</span> &amp; c)).<span class="built_in">append</span>(<span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 采用ide默认编码</div><div class="line">     * Convert byte[] to hex string.这里我们可以将byte转换成int，然后利用Integer.toHexString(int)来转换成16进制字符串。</div><div class="line">     * @param str      转换字符串</div><div class="line">     * @param encoding 编码</div><div class="line">     * @return hex string</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> toHexBits(<span class="keyword">String</span> <span class="built_in">str</span>, <span class="keyword">String</span> encoding) <span class="keyword">throws</span> UnsupportedEncodingException &#123;</div><div class="line">        <span class="built_in">byte</span>[] src;</div><div class="line">        <span class="keyword">if</span> (encoding == <span class="keyword">null</span>) &#123;</div><div class="line">            src = <span class="built_in">str</span>.getBytes();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            src = <span class="built_in">str</span>.getBytes(encoding);</div><div class="line">        &#125;</div><div class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder(<span class="string">""</span>);</div><div class="line">        <span class="keyword">if</span> (src == <span class="keyword">null</span> || src.length &lt;= <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; src.length; i++) &#123;</div><div class="line">            <span class="built_in">int</span> v = src[i] &amp; <span class="number">0xFF</span>;</div><div class="line">            <span class="keyword">String</span> hv = Integer.toHexString(v);</div><div class="line">            <span class="keyword">if</span> (hv.length() &lt; <span class="number">2</span>) &#123;</div><div class="line">                stringBuilder.<span class="built_in">append</span>(<span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">            stringBuilder.<span class="built_in">append</span>(hv + <span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        System.out.<span class="built_in">println</span>(fixLength(encoding) + <span class="string">":"</span> + stringBuilder.toString());<span class="comment">//格式化输出</span></div><div class="line">        <span class="keyword">return</span> stringBuilder.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 格式化输出.</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> fixLength(<span class="keyword">String</span> name) &#123;</div><div class="line">        <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</div><div class="line">            name = <span class="keyword">new</span> <span class="keyword">String</span>(<span class="string">"null       "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (name.length() &lt; <span class="number">11</span>) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; name.length() &lt; <span class="number">11</span>; i++) &#123;</div><div class="line">                name += <span class="string">" "</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.windyyong.com/2016/08/28/字符编码：三、了解编码方式Encoding/" data-id="ciy9qygjy000c14uepbaty19b" class="article-share-link">分享到</a><div class="tags"><a href="/tags/字符编码/">字符编码</a></div><div class="post-nav"><a href="/2016/08/28/字符编码：二、认识字符集Charset/" class="pre">字符编码：二、认识字符集Charset</a><a href="/2016/08/28/字符编码：四、Unicode与UTF-8/" class="next">字符编码：四、Unicode与UTF-8</a></div><div data-thread-key="2016/08/28/字符编码：三、了解编码方式Encoding/" data-title="字符编码：三、了解编码方式Encoding" data-url="http://www.windyyong.com/2016/08/28/字符编码：三、了解编码方式Encoding/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/08/28/字符编码：三、了解编码方式Encoding/" data-title="字符编码：三、了解编码方式Encoding" data-url="http://www.windyyong.com/2016/08/28/字符编码：三、了解编码方式Encoding/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://www.windyyong.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java基础/">Java基础</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java构建工具/">Java构建工具</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Maven/" style="font-size: 15px;">Maven</a> <a href="/tags/字符编码/" style="font-size: 15px;">字符编码</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/12/25/Maven打包配置文件说明/">Maven打包配置说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：一、Unicode与UTF-8的例子/">字符编码：一、Unicode与UTF-8的例子</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：二、认识字符集Charset/">字符编码：二、认识字符集Charset</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：三、了解编码方式Encoding/">字符编码：三、了解编码方式Encoding</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：四、Unicode与UTF-8/">字符编码：四、Unicode与UTF-8</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：TXT与编码/">字符编码：TXT与编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/28/字符编码：Unicode的历史/">字符编码：Unicode的历史</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.windyyong.com" title="windy" target="_blank">windy</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">windy.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> </a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'windyyong'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>